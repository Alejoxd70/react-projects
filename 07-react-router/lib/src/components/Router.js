import{jsx as _jsx}from"react/jsx-runtime";import{useState,useEffect,Children}from"react";import{EVENTS}from"../const";import{match}from"path-to-regexp";import{getCurrentPath}from"../utils";export const Router=({children,routes=[],defaultComponent:DefaultComponent=()=>_jsx("h1",{children:"404"})})=>{const[currentPage,setCurrentPage]=useState(getCurrentPath());useEffect(()=>{const handleNavigation=()=>{setCurrentPage(getCurrentPath())};window.addEventListener(EVENTS.PUSHSTATE,handleNavigation);window.addEventListener(EVENTS.POPSTATE,handleNavigation);return()=>{window.removeEventListener(EVENTS.PUSHSTATE,handleNavigation);window.removeEventListener(EVENTS.POPSTATE,handleNavigation)}},[]);const routesFromChildren=Children.map(children,({props,type})=>{const{name}=type;const isRoute=name==="Route";return isRoute?props:null});const routesTouse=routes.concat(routesFromChildren).filter(Boolean);let routeParams={};const Page=routesTouse.find(route=>{if(route.path===currentPage)return true;const matcherUrl=match(route.path,{decode:decodeURIComponent});const matched=matcherUrl(currentPage);if(!matched)return false;routeParams=matched.params;return true})?.component;return Page?_jsx(Page,{routeParams:routeParams}):_jsx(DefaultComponent,{routeParams:routeParams})};